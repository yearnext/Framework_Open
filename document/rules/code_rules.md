# 框架编程规范
## 1. 规范制定原则
1. 方便代码的交流和维护。
2. 不影响编码的效率，不与大众习惯冲突。
3. 使代码更美观、阅读更方便。
4. 使代码的逻辑更清晰、更易于理解。

## 2. 代码外观
### 2.1 列宽
代码列宽控制在110字符左右。

### 2.2 换行
当表达式超出或即将超出规定的列宽，遵循以下规则进行换行：

1. 在逗号后换行。
2. 在操作符前换行。
3. 规则1优先于规则2。

当以上规则会导致代码混乱的时候自己采取更灵活的换行规则。

### 2.3 缩进
缩进应该是每行一个Tab(4个空格)，不要在代码中使用Tab字符（可以在IDE中设置使用4个空格替代Tab字符）。

### 2.4 空行
空行是为了将逻辑上相关联的代码分块，以便提高代码的可阅读性。
在以下情况下建议使用空行：
1. 函数与函数之间应使用空行隔开。
2. 功能块和功能块之间应使用空行隔开。
3. 数据类型和数据类型之间应使用空行隔开。

### 2.5 空格
在以下情况中要使用到空格：
1. 关键字和左括符 “(” 应该用空格隔开（注意在函数名和左括符 “(” 之间不要使用空格，这样有助于辨认代码中的方法调用与关键字）。
2. 多个参数用逗号隔开，每个逗号后都应加一个空格。
3. 除了“.”之外，所有的二元操作符都应用空格与它们的操作数隔开。一元操作符、++及--与操作    数间不需要空格。
4. 语句中的表达式之间用空格隔开。

### 2.6 括号
1. 左括号“(” 不要紧靠关键字，中间用一个空格隔开。
2. 左括号“(”  与函数名之间不要添加任何空格。
3. 没有必要的话不要在返回语句中使用()。

### 2.7 花括号
1. 左花括号 “{” 放于关键字或函数名的下一行并与之对齐。
2. 左花括号 “{” 要与相应的右花括号 “}”对齐。
3. 通常情况下左花括号 “{”单独成行，不与任何语句并列一行。
4. if、while、do语句后一定要使用**{}**，即使**{}**号中为空或只有一条语句。
5. 右花括号“}”后建议加一个注释以便于方便的找到与之相应的“{”。

## 3. 代码注释
### 3.1 概述
1. 修改代码时，总是使代码周围的注释保持最新。
2. 在每个例程的开始，提供标准的注释样本以指示例程的用途、假设和限制很有帮助。注释样本应该是解释它为什么存在和可以做什么的简短介绍。
3. 避免在代码行的末尾添加注释；行尾注释使代码更难阅读。不过在批注变量声明时，行尾注释是合适的；在这种情况下，将所有行尾注释在公共制表位处对齐。
4. 避免杂乱的注释，如一整行星号。而是应该使用空白将注释同代码分开。
5. 避免在块注释的周围加上印刷框。这样看起来可能很漂亮，但是难于维护。
6. 在部署发布之前，移除所有临时或无关的注释，以避免在日后的维护工作中产生混乱。
7. 如果需要用注释来解释复杂的代码节，请检查此代码以确定是否应该重写它。尽一切可能不注释难以理解的代码，而应该重写它。尽管一般不应该为了使代码更简单以便于人们使用而牺牲性能，但必须保持性能和可维护性之间的平衡。
8. 在编写注释时使用完整的句子。注释应该阐明代码，而不应该增加多义性。
9. 在编写代码时就注释，因为以后很可能没有时间这样做。另外，如果有机会复查已编写的代码，在今天看来很明显的东西六周以后或许就不明显了。
10. 避免多余的或不适当的注释，如幽默的不主要的备注。
11. 使用注释来解释代码的意图。它们不应作为代码的联机翻译。
12. 注释代码中不十分明显的任何内容。
13. 为了防止问题反复出现，对错误修复和解决方法代码总是使用注释，尤其是在团队环境中。
14. 对由循环和逻辑分支组成的代码使用注释。这些是帮助源代码读者的主要方面。
15. 在整个应用程序中，使用具有一致的标点和结构的统一样式来构造注释。
16. 用空白将注释同注释分隔符分开。在没有颜色提示的情况下查看注释时，这样做会使注释很明显且容易被找到。
17. 在所有的代码修改处加上修改标识的注释。
18. 为了是层次清晰，在闭合的右花括号后注释该闭合所对应的起点。

### 3.2 变量注释规范
	
	/** core tick variable */
	volatile uint32_t coreTick = CORE_TICK_MIN;

### 3.3 枚举注释规范

	/**
	 *******************************************************************************
	 * @brief        demo
	 *******************************************************************************
	 */
	enum
	{
		/** event max enum */
		EVENT_MIN,

		/** event max enum */
		EVENT_MAX,
	};

### 3.4 结构体、联合注释规范

	/**
	 *******************************************************************************
	 * @brief        demo
	 *******************************************************************************
	 */
	struct DemoStructure
	{
		/** max number */
		uint8_t NumberMax,

		/** min number */
		uint8_t NumberMin,
	};

	/**
	 *******************************************************************************
	 * @brief        demo
	 *******************************************************************************
	 */
	union DemoUnion
	{
		/** max number */
		uint8_t NumberMax;

		/** min number */
		uint8_t NumberMin,
	};

### 3.5 模块、模组注释规范
	/**
	 *******************************************************************************
	 * @brief        define param about tick
	 *******************************************************************************
	 */
	#define CORE_TICK_MAX (10000000UL)
	#define CORE_TICK_MIN (0UL)

	volatile uint32_t coreTick = CORE_TICK_MIN;

### 3.6 函数注释规范

    /**
     *******************************************************************************
     * @brief     stop timer
     * @param     [in/out]  timerId         timer id number
     * @return    [in/out]  ERR_NONE        no error
     * @note      None
     *******************************************************************************
     */
    err_t TimerStop(uint8_t timerId)
    {
	    return ERR_NONE;
    }

## 5. 命名
### 5.1 命名原则
选择正确名称时的困难可能表明需要进一步分析或定义项的目的。使名称足够长以便有一定的意义，并且足够短以避免冗长。唯一名称在编程上仅用于将各项区分开。表现力强的名称是为了帮助人们阅读；因此，提供人们可以理解的名称是有意义的。不过，请确保选择的名称符合适用语言的规则和标准。

以下几点是推荐的命名方法。
1. 避免容易被主观解释的难懂的名称（存在多义性）。
2. 在类属性的名称中包含类名是多余的，如 Book.BookTitle。而是应该使用 Book.Title。
3. 只要合适，在变量名的末尾或开头加计算限定符（Avg、Sum、Min、Max、Index）。
4. 在变量名中使用互补对，如 min/max、begin/end 和 open/close。
5. 布尔变量名应该包含 Is，这意味着 Yes/No 或 True/False 值，如 fileIsFound。
6. 在命名状态变量时，避免使用诸如 Flag 的术语。状态变量不同于布尔变量的地方是它可以具有两个以上的可能值。不是使用 documentFlag，而是使用更具描述性的名称，如 documentFormatType（此项只供参考）。 
7. 即使对于可能仅出现在几个代码行中的生存期很短的变量，仍然使用有意义的名称。仅对于短循环索引使用单字母变量名，如 i 或 j。 可能的情况下，尽量不要使用原义数字或原义字符串。

本框架的编程的命名方式主要有Pascal（将标识符的首字母和后面连接的每个单词的首字母都大写）、Camel（标识符的首字母小写，而每个后面连接的单词的首字母都大写）以及下划线命名的方式。

### 5.2 命名规则
|标识符|命名规则|示例|
|:-:|:-:|:-:|
|结构变量|Pascal|UserTimer|
|结构类型|Pascal|UserTimer_TypeDef|
|枚举值|Pascal|ERR_NONE|
|枚举类型|Pascal|ErrorLevel_TypeDef|
|常量|Pascal|RedValue|
|全局变量|Pascal|BatteryVoltage|
|宏|Pascal|USE_TIM_NUM|
|函数|Pascal|ToString(注意：驱动程序需要讲究层次结构，例如IO初始化函数命名为：MAP_GPIO_Init)|
|命名空间|Pascal|System.Drawing|
|参数|Camel|typeName|
|局部变量|Camel|firstData|

#### 补充
**结构体成员**

结构体成员命名时，使用Pascal命名规则。

示例：

struct DemoStructure
{
    uint8_t Variable;
};

### 5.3 缩写原则
为了避免混淆和保证跨语言交互操作，请遵循有关区缩写的使用的下列规则：
1. 不要将缩写或缩略形式用作标识符名称的组成部分。例如，使用 GetWindow，而不要使用 GetWin。
2. 不要使用计算机领域中未被普遍接受的缩写。
3. 在适当的时候，使用众所周知的缩写替换冗长的词组名称。例如，用UI作为User Interface缩写。
4. 在使用缩写时，对于超过两个字符长度的缩写请使用 Pascal 大小写或 Camel 大小写，但是，应当大写仅有两个字符的缩写，如，System.IO，而不是 System.Io。
5. 不要在标识符或参数名称中使用缩写。如果必须使用缩写，对于由多于两个字符所组成的缩写请使用Camel 大小写，虽然这和单词的标准缩写相冲突。

### 5.4 文件命名
文件名使用下划线命名法，命名方式为结构名称(或缩写)+功能名称，结构名称(或缩写)和功能名称通过下划线连接在一起。

示例：
    
    fw_timer.c               //! 此为框架中的定时器组件源文件

### 5.5 文件头
每个文件必须要有一个文件头，用来标注一些文件的相关信息。文件头以注释的形式存在于源文件或头文件中，格式如下：

	/**
	 *******************************************************************************
	 *                   Copyright (C) 时间  版权归属 <联系方式>                      *
	 *                                                                             *
	 *                                  协议内容                                    *
	 *******************************************************************************
	 * @file       文件名                                                           *
	 * @author     创建作者                                                         *
	 * @version    当前版本号                                                       *
	 * @date       更新日期（格式为 XXXX-XX-XX）                                     *
	 * @brief      文件描述                                                         *
	 * @par        工作平台                                                         *
	 *                 程序工作的平台                                                *
	 * @par        编译平台                                                         *
	 *                 程序编译的平台                                                * 
	 *******************************************************************************
	 * @note                                                                       *
	 * 1. 需要标注的信息                                                             *
	 *******************************************************************************
	 */

注：
1. 文件功能描述只需简述，具体详情在类的注释中描述。
2. 模版中的中文内容在实际文件中需要使用英文代替。
3. 建议在note中填写文件变动信息。

### 5.6 接口
以下规则概述接口的命名指南：

1. 用名词或名词短语，或者描述行为的形容词命名接口。
2. 使用 Pascal 大小写。
3. 少用缩写。

## 6. 语句
### 6.1 每行一个语句
每行最多包含一个语句。

###  6.2 复合语句
使用复合语句应遵循以下几点:
1. 子语句要缩进。
2. 左花括号“{” 在复合语句父语句的下一行并与之对齐，单独成行。
3. 即使只有一条子语句要不要省略花括号“{}”。

###  6.3 return语句
return语句中不使用括号，除非它能使返回值更加清晰。

## 7. 其他
### 7.1 表达式
1. 避免在表达式中用赋值语句。
2. 避免对浮点类型做等于或不等于判断。

### 7.2 类型转换
1. 尽量避免强制类型转换。
2. 如果不得不做类型转换，尽量用显式方式。

## 8. 参考资料
[1]. [C#编程规范](http://www.cnblogs.com/jailu/archive/2007/07/17/820959.html)     
[2]. [基于Doxygen的C/C++注释原则](http://blog.csdn.net/wenrenhua08/article/details/39591239)
[3]. [Doxygen详细介绍（三）（Doxygen注释风格）](http://ticktick.blog.51cto.com/823160/188674/)

## 附录一: 匈牙利命名法
匈牙利命名法是一名匈牙利程序员发明的，而且他在微软工作了多年。此命名法就是通过微软的各种产品和文档传出来的。多数有经验的程序员，不管他们用的是哪门儿语言，都或多或少在使用它。

这种命名法的基本原则是： 变量名＝属性＋类型＋对象描述

即一个变量名是由三部分信息组成，这样，程序员很容易理解变量的类型、用途，而且便于记忆。

下边是一些推荐使用的规则例子，你可以挑选使用，也可以根据个人喜好作些修改再用之。

|应用|规则|示例|
|:-:|:-:|:-:|
|属性|全局变量|**g_**|
|-|常量|**c_**|
|-|类成员变量|**m_**|
|类型|指针|**p**|
|-|句柄|**h**|
|-|布尔型|**b**|
|-|浮点型|**f**|
|-|无符号|**u**|
|描述|初始化|**Init**|
|-|临时变量|**Tmp**|
|-|目的对象|**Dst**|
|-|源对象|**Src**|
|-|窗口|**Wnd**|

举例：
hwnd： h表示句柄，wnd表示窗口，合起来为“窗口句柄”。
m_bFlag： m表示成员变量，b表示布尔，合起来为：“某个类的成员变量，布尔型，是一个状态标志”。